<section class="watchlist-section py-4 bg-dark">
  <div class="container">
    <!-- Section Header -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h3 class="mb-2 d-flex align-items-center text-white">
              <fa-icon [icon]="faHeart" class="text-danger me-2"></fa-icon>
              Your Watchlist
            </h3>
            <p class="text-white mb-0">
              {{ watchlistMovies.length }} movie{{
                watchlistMovies.length !== 1 ? "s" : ""
              }}
              saved for later
            </p>
          </div>
          <div class="d-flex align-items-center gap-2">
            <!-- Scroll Controls -->
            <button
              *ngIf="watchlistMovies.length > itemsPerView"
              class="btn btn-outline-secondary btn-sm"
              [disabled]="currentIndex === 0"
              (click)="scrollLeft()"
            >
              <fa-icon [icon]="faChevronLeft"></fa-icon>
            </button>
            <button
              *ngIf="watchlistMovies.length > itemsPerView"
              class="btn btn-outline-secondary btn-sm"
              [disabled]="currentIndex >= maxIndex"
              (click)="scrollRight()"
            >
              <fa-icon [icon]="faChevronRight"></fa-icon>
            </button>
            <!-- View All Button -->
            <button
              *ngIf="watchlistMovies.length > 0"
              class="btn btn-outline-primary btn-sm"
              (click)="viewAllWatchlist()"
            >
              View All
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty Watchlist State -->
    <div *ngIf="watchlistMovies.length === 0" class="row">
      <div class="col-12">
        <div class="empty-watchlist text-center py-5">
          <div class="mb-3">
            <fa-icon
              [icon]="faHeart"
              class="text-muted"
              style="font-size: 4rem"
            ></fa-icon>
          </div>
          <h4 class="text-muted mb-2">Your watchlist is empty</h4>
          <p class="text-muted mb-4">
            Start adding movies you want to watch by clicking the heart icon on
            any movie card
          </p>
          <button class="btn btn-primary" (click)="exploreMovies()">
            Explore Movies
          </button>
        </div>
      </div>
    </div>

    <!-- Watchlist Movies -->
    <div *ngIf="watchlistMovies.length > 0" class="watchlist-scroll-container">
      <div
        class="row flex-nowrap"
        [style.transform]="'translateX(' + scrollOffset + 'px)'"
      >
        <div
          *ngFor="let movie of visibleMovies; let i = index"
          class="col-auto watchlist-item"
          [style.animation-delay]="i * 100 + 'ms'"
        >
          <div class="watchlist-card">
            <!-- Movie Poster -->
            <div class="poster-container position-relative">
              <img
                [src]="getImagePath(movie)"
                [alt]="movie.title"
                class="movie-poster"
                (click)="viewMovieDetails(movie.id)"
                onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDIwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjIwMCIgaGVpZ2h0PSIzMDAiIGZpbGw9IiMzQTNBM0EiLz48cmVjdCB4PSI3NSIgeT0iMTIwIiB3aWR0aD0iNTAiIGhlaWdodD0iMzAiIGZpbGw9IiM2NjY2NjYiLz48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxODAiIHI9IjE1IiBmaWxsPSIjNjY2NjY2Ii8+PC9zdmc+'"
              />

              <!-- Remove from Watchlist -->
              <button
                class="btn btn-danger btn-sm remove-btn position-absolute top-0 end-0 m-2"
                (click)="removeFromWatchlist(movie, $event)"
                title="Remove from Watchlist"
              >
                <fa-icon [icon]="faHeart"></fa-icon>
              </button>

              <!-- Hover Overlay -->
              <div
                class="hover-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center"
              >
                <button
                  class="btn btn-primary"
                  (click)="viewMovieDetails(movie.id)"
                >
                  View Details
                </button>
              </div>
            </div>

            <!-- Movie Info -->
            <div class="movie-info p-2">
              <h6 class="movie-title mb-1" [title]="movie.title">
                {{ movie.title }}
              </h6>
              <small class="text-muted">{{
                getMovieYear(movie.release_date)
              }}</small>
              <div class="rating mt-1">
                <span class="badge bg-warning text-dark">
                  ‚≠ê {{ movie.vote_average | number : "1.1-1" }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll Indicators -->
    <div
      *ngIf="watchlistMovies.length > itemsPerView"
      class="scroll-indicators d-flex justify-content-center mt-3"
    >
      <div
        *ngFor="let page of scrollPages; let i = index"
        class="indicator"
        [class.active]="i === currentPage"
        (click)="goToPage(i)"
      ></div>
    </div>
  </div>
</section>
